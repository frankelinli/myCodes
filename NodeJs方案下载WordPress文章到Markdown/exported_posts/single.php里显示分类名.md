---
id: 66
title: single.php里显示分类名
date: '2025-04-17T07:26:17'
author: haoye
categories:
  - notes
tags: []
---

WordPress主题开发中常用的一个函数`the_category()`。让我解释一下这个函数的用法和您提到的情况：

`the_category(', ');`这行代码的作用是输出当前文章的所有分类，默认情况下，多个分类会用逗号和空格（’, ‘）分隔。

然而，您想要”直接输出第一个”分类。要实现这个目的，我们需要稍微修改一下代码。以下是几种方法可以只输出第一个分类：

1. 使用`get_the_category()`函数：

```
$categories = get_the_category();
if (!empty($categories)) {
    echo esc_html($categories[0]->name);
}
```

2. 使用`wp_get_post_categories()`函数：

```
$categories = wp_get_post_categories(get_the_ID(), array('fields' => 'names'));
if (!empty($categories)) {
    echo esc_html($categories[0]);
}
```

3. 如果您仍然想使用`the_category()`函数，但只显示第一个分类，可以这样做：

```
the_category(', ', '', false);
```

在这个用法中，第三个参数设为空字符串，第四个参数设为`false`，这样就只会输出第一个分类。

这些方法都可以实现只输出第一个分类的目的。选择哪种方法取决于您的具体需求和代码结构。

需要注意的是，如果文章没有分配任何分类，这些代码都不会输出任何内容。您可能需要添加额外的检查或默认值，以处理没有分类的情况。

您希望我详细解释其中的任何一种方法吗？

您提出了一个很好的观点。在single.php中，确实可能不需要进行额外的检查。让我解释一下原因：

1. 单篇文章页面（single.php）通常是用来显示一篇完整的文章的。

2. 在WordPress的默认设置中，每篇文章至少应该属于一个分类。即使用户没有明确选择分类，文章也会被分配到默认分类（通常是”未分类”或”Uncategorized”）。

3. 因此，在理论上，single.php 中显示的文章应该总是有至少一个分类。

基于这些考虑，您可以直接使用以下代码而不进行额外检查：

```
$categories = get_the_category();
echo esc_html($categories[0]->name);
```

或者：

```
the_category(', ', '', false);
```

这两种方法都应该能够正常工作，而不会产生错误或警告。

但是，我还是建议您考虑以下几点：

1. 自定义文章类型：如果您的网站使用了自定义文章类型，它们可能不一定使用标准的分类系统。

2. 插件影响：某些插件可能会改变WordPress的默认行为。

3. 未来的维护性：虽然现在可能不需要检查，但将来如果网站结构发生变化，有检查可能会更安全。

4. 代码复用：如果这段代码将来可能被复制到其他地方使用，有检查会使它更加通用。

如果您确定在您的具体情况下不需要这种检查，那么直接使用上述代码是完全可以的。这样可以使代码更简洁，也可能略微提高性能（尽管差异可能微不足道）。

最终，这是一个关于代码风格和个人偏好的决定。在确保功能正常的前提下，选择您认为最适合您项目的方式。
